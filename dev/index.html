<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · VlasovSolvers.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://juliavlasov.github.io/VlasovSolvers.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="VlasovSolvers.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>VlasovSolvers.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Splitting"><span>Splitting</span></a></li><li><a class="tocitem" href="#Semi-Lagrangian-method"><span>Semi-Lagrangian method</span></a></li><li><a class="tocitem" href="#Numerical-method-for-Poisson-equation"><span>Numerical method for Poisson equation</span></a></li><li><a class="tocitem" href="#Algorithm"><span>Algorithm</span></a></li></ul></li><li><a class="tocitem" href="problem/">Problem type</a></li><li><a class="tocitem" href="vlasov-poisson/">Vlasov-Poisson</a></li><li><a class="tocitem" href="vlasov-ampere/">Vlasov-Ampere</a></li><li><a class="tocitem" href="bump_on_tail/">Bump On Tail</a></li><li><a class="tocitem" href="rotation2d/">Rotation 2D</a></li><li><a class="tocitem" href="vlasov-hmf/">Vlasov-HMF</a></li><li><a class="tocitem" href="tsi/">Two-stream instability</a></li><li><a class="tocitem" href="contents/">Contents</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaVlasov/VlasovSolvers.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="VlasovSolvers.jl"><a class="docs-heading-anchor" href="#VlasovSolvers.jl">VlasovSolvers.jl</a><a id="VlasovSolvers.jl-1"></a><a class="docs-heading-anchor-permalink" href="#VlasovSolvers.jl" title="Permalink"></a></h1><p><em>First draft of a Vlasov solvers Julia suite.</em></p><p>The Vlasov equation is of paramount importance in plasma physics. It is a nonlinear transport equation  satisfied by the distribution function <span>$f$</span> of the considered charged particles (ions or electrons typically).   The Vlasov equation is a kinetic equation which means the unknown <span>$f$</span> not only depends on time <span>$t$</span> and space <span>$x$</span>  but also on the velocity repartition of the particles through the variable <span>$v$</span>. Hence, the distribution function  <span>$f$</span> depends on <span>$t\geq 0$</span>, <span>$x\in \Omega\subset \mathbb{R}^d$</span> and <span>$v\in \mathbb{R}^d$</span> with <span>$d\geq 1$</span> the dimension of the problem. </p><p>The main goal of this library is to propose some efficient numerical tools to solve numerically the Vlasov-Poisson equation  using the semi-Lagrangian method. </p><p>We consider a population of electrons whereas the ions are supposed stationary with a constant density equal to one.  The spatial domain <span>$\Omega$</span> is a torus in dimension <span>$d$</span> so that <span>$x\in \Omega=[0, L]^d$</span> with periodic boundary conditions.   In this framework, the Vlasov-Poisson equation we intend to solve can be written as  </p><p class="math-container">\[\partial_t f + v\cdot \nabla_x f + E\cdot \nabla_v f =0, \]</p><p>where the electric field <span>$E=E(t, x)\in \mathbb{R}^d$</span> depends on the solution <span>$f$</span> through the Poisson equation </p><p class="math-container">\[\nabla_x \cdot E=  \int f dv - 1. \]</p><p>The electric field is supposed to derive from an electric potential <span>$\phi(t, x)\in \mathbb{R}$</span> so that  <span>$E(t, x)=-\nabla_x \phi(t, x)$</span> and <span>$\phi$</span> solves the following elliptic equation </p><p class="math-container">\[-\Delta \phi=  \int f dv - 1. \]</p><p>In the following, some elements detailing the numerical method developed in the library are given  (splitting, semi-Lagrangian method, Poisson equation solver). </p><h2 id="Splitting"><a class="docs-heading-anchor" href="#Splitting">Splitting</a><a id="Splitting-1"></a><a class="docs-heading-anchor-permalink" href="#Splitting" title="Permalink"></a></h2><p>Splitting methods enable to reduce the resolution of complex systems into the successive   resolution of simple problems. The way complex systems are split strongly depends on the  considered problem. For the Vlasov-Poisson system, we appeal to its specific Hamiltonian structure (see Casas-Crouseilles-Faou-Mehrenberger),  which enables to split the Vlasov equation into the two following parts </p><p class="math-container">\[\partial_t f + v\cdot \nabla_x f=0 \;\; \mathrm{ and } \;\; \partial_t f +
E\cdot \nabla_v f=0, \]</p><p>so that the numerical solution can be approximated by the successive solution of each part. Indeed, if we denote <span>$\varphi^x_t(f_0)$</span> the solution at time <span>$t$</span> of</p><p class="math-container">\[\partial_t f + v\cdot \nabla_x f=0, \]</p><p>and <span>$\varphi^v_t(f_0)$</span> the solution at time <span>$t$</span> of</p><p class="math-container">\[\partial_t f + E\cdot \nabla_v f=0, \]</p><p>then the solution <span>$\varphi_t(f_0)$</span> of the Vlasov equation can be approximated by</p><p class="math-container">\[\varphi_t(f_0) \approx \varphi^v_t \circ \varphi^x_t(f_0).  \]</p><p>A very interesting aspect of this splitting comes from the fact that each subpart <span>$\varphi^x_t(f_0)$</span> and <span>$\varphi^v_t(f_0)$</span>  can be solved exactly in time. Indeed, the solution at time <span>$t$</span> of <span>$\partial_t f + v\cdot \nabla_x f=0$</span>  with a given initial condition <span>$f(0, x, v)=f_0(x, v)$</span> is <span>$f(t, x, v)=f_0(x-vt, v)$</span>.  For a given electric field <span>$E(t, x)$</span> (typically obtained from the solution of the Poisson equation), the   solution at time <span>$t$</span> of </p><p class="math-container">\[\partial_t f + E\cdot \nabla_v f=0\]</p><p>with a given initial condition <span>$f(0, x, v)=f_0(x, v)$</span> is </p><p class="math-container">\[f(t, x, v)=f_0(x, v-E(0, x) t). \]</p><p>Indeed, it is worth mentioning that the electric field <span>$E$</span> does not depend on time during this step. Since <span>$E$</span> only depends on <span>$\int f dv$</span>, the velocity integration of </p><p class="math-container">\[\partial_t f + E\cdot \nabla_v f=0\]</p><p>leads to </p><p class="math-container">\[\frac{d}{dt}\int f dv = 0\]</p><p>so that <span>$\frac{d}{dt} E(t, x) = 0$</span> and <span>$E(t, x)=E(0, x)$</span> along this step.</p><p>This is the Lie-Trotter splitting which is a first order approximation of the solution <span>$f(t)$</span>. High order splittings can be derived by choosing a sequence of coefficients <span>$(a_i, b_i)$</span> so that</p><p class="math-container">\[\varphi_t(f_0) \approx \Pi_{i} \;\;  \Big(\varphi^v_{a_i t} \circ \varphi^x_{b_i t}\Big)(f_0).  \]</p><p>The splitting enables us to reduce the original problem into several smaller problems which are easier to solve. Indeed, in the Vlasov case, we are led to solve one dimensional linear transport equations which we choose to solve using the semi-Lagrangian method.  The basics of the semi-Lagrangian method are recalled in the following. </p><p>We are faced with multidimensional linear transport equation which can be split again  into one dimensional linear transport equation. Indeed, for the part </p><p class="math-container">\[\partial_t f + v\cdot \nabla_x f = 0,\]</p><p>we can split exactly this <span>$d$</span>-dimensional transport equation into </p><p class="math-container">\[\partial_t + v_\alpha \partial_{x_\alpha} f = 0, \;\; \alpha=1, \ldots, d,   \]</p><p>where <span>$x_\alpha$</span> (resp. <span>$v_\alpha$</span>) denotes the <span>$\alpha$</span>-th component of <span>$x$</span> (resp. <span>$v$</span>).  Similarly, we can  split exactly the part <span>$\partial_t f + E\cdot \nabla_v f = 0$</span>  into <span>$d$</span> one dimensional linear transport equations </p><p class="math-container">\[\partial_t + E_\alpha \partial_{v_\alpha} f = 0, \;\; \alpha=1, \ldots, d,    \]</p><p>where <span>$E_\alpha$</span> denotes the <span>$\alpha$</span>-th compoent of the electric field <span>$E$</span>. </p><h2 id="Semi-Lagrangian-method"><a class="docs-heading-anchor" href="#Semi-Lagrangian-method">Semi-Lagrangian method</a><a id="Semi-Lagrangian-method-1"></a><a class="docs-heading-anchor-permalink" href="#Semi-Lagrangian-method" title="Permalink"></a></h2><p>According to the previous section, we are led to solve the following linear transport equation </p><p class="math-container">\[\partial_t f + a \partial_x f=0, f(t=0, x) = f_0(x), x\in [0, L], \]</p><p>with periodic boundary conditions. According to the above notations,  <span>$x$</span> denotes here the spatial or velocity direction. </p><p>We know that the exact solution of <span>$\partial_t f + a \partial_x f=0$</span> can be written as</p><p class="math-container">\[f(t, x) = f_0(x-at), \]</p><p>or if we consider the solution from time <span>$s$</span> to <span>$t$</span>`, we have</p><p class="math-container">\[f(t, x) = f(s, x-a(t-s)).  \]</p><p>The property that <span>$f$</span> is constant along the characteristics paves the way of the semi-Lagrangian method. Indeed, let&#39;s consider a time discretization <span>$t_n = n\Delta t, n\in \mathbb{N}$</span>, <span>$\Delta t&gt;0$</span> and a space discretization <span>$x_i=i\Delta x, i\in N_x, \Delta x&gt;0, \Delta x=L/N_x$</span> where <span>$N_x$</span> is the number of points.  Considering <span>$t=t_{n+1}, s=t_n$</span> and <span>$x=x_i$</span> in the former equation, we get </p><p class="math-container">\[f(t_{n+1}, x_i) = f(t_n, x_i-a \Delta t).  \]</p><p>We assume that <span>$f(t_n, x_i)$</span> are all known, we have to compute <span>$f(t_n, x_i-a \Delta t)$</span> and this is done by a standard interpolation method. For the Vlasov problem, high order interpolation are required (citer Francis, Sonnen, Michel...).  Within the framework of this package, we have chosen  piecewise polynomial interpolation of two kinds: Lagrange interpolation or B-splines interpolation (of odd degree).  Arbitrary high order of Lagrange and B-splines polynomials are  available and have been tested according to recent estimates (citer Michel-Latu-Sonnen). </p><p>For <span>$p$</span> order Lagrange interpolation, we have</p><p class="math-container">\[f(t_n, x) = \sum_{i=0}^k f(t_n, x_i) L_{i,p}(x), \]</p><p>where </p><p class="math-container">\[L_{i,p}(x) = \Pi_{0\leq k\leq p, k\neq i} \frac{x-x_k}{x_i-x_k}, \;\;
\mathrm{ for }\; 0\leq i\leq p.  \]</p><p>For the B-spline interpolation of order <span>$p$</span>, we have</p><p class="math-container">\[f(t_n, x) = \sum_{i=0}^{N_x-1} \eta_i B_{i,p}(x) \]</p><p>where </p><p class="math-container">\[B_{i,0}(x) := \left\{
\begin{matrix}
1 &amp; \mathrm{if}  \quad \tau_i \leq x &lt; \tau_{i+1} \\
0 &amp; \mathrm{otherwise} 
\end{matrix}
\right.\]</p><p class="math-container">\[B_{i,p}(x) := \frac{x - \tau_i}{\tau_{i+p} - \tau_i} B_{i,p-1}(x) 
+ \frac{\tau_{i+p+1} - x}{\tau_{i+p+1} - \tau_{i+1}} B_{i+1,p-1}(x).\]</p><p>and the coefficients <span>$(\eta_i)_{i=0, \dots, N_x-1}$</span> are solution of a linear system to solve (cite De Boor, Michel, ...).</p><h2 id="Numerical-method-for-Poisson-equation"><a class="docs-heading-anchor" href="#Numerical-method-for-Poisson-equation">Numerical method for Poisson equation</a><a id="Numerical-method-for-Poisson-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-method-for-Poisson-equation" title="Permalink"></a></h2><p>The Poisson equation with periodic boundary condition is solved using Fourier techniques. First, we consider the following DFT (Discrete Fourier Transform) of a <span>$L-$</span>periodic function <span>$g$</span> defined on a mesh of <span>$N_x$</span> points such that <span>$x_j=j \Delta x, \Delta x=L/N_x, 0\leq j\leq N_x-1$</span> </p><p class="math-container">\[\hat{g}_k := \frac{1}{N_x}\sum_{j=0}^{N_x-1} g(x_j) e^{-i \frac{2\pi}{L} k
x_j}, \;\; k=0, \dots, N_x-1. \]</p><p>Thus, from the Poisson equation,  </p><p class="math-container">\[\partial_x E = \rho -1, \]</p><p>we consider the Fourier transform to get</p><p class="math-container">\[i k \hat{E}_k = \hat{\rho}_k \;\; \mathrm{  if  } \;\;  k\neq 0, \;\;
\hat{E}_0=0.  \]</p><p>Then, we can compute the Fourier coefficients <span>$\hat{E}_k$</span> as</p><p class="math-container">\[\hat{E}_k = \frac{1}{ik}\hat{\rho}_k,  \]</p><p>and an inverse Fourier transform is used to get <span>$E_i\approx E(x_i)$</span>. </p><p>The extension of this algorithm to the multidimensional case requires to introduce the electric potential <span>$\varphi$</span> such that <span>$E=-\nabla_x \phi$</span>. The scalar electric potential solves an elliptic Poisson equation</p><p class="math-container">\[-\Delta \phi = \rho -1\]</p><p>which is also solved using Fourier techniques. Now we get (now <span>$k$</span> is a vectorial wavenumber) </p><p class="math-container">\[|k|^2 \hat{\phi}_k = \hat{\rho}_k \;\; \mathrm{  if  } \;\;  k\neq 0, \;\;
\hat{\phi}_0=0.  \]</p><p>so that <span>$\hat{\phi}_k = \hat{\rho}_k/|k|^2$</span> and the electric field can be computed using</p><p class="math-container">\[\hat{E}_k = -ik \hat{\phi}_k  \;\; \mathrm{  if  } \;\;  k\neq 0, \;\;
\hat{E}_0=0.  \]</p><p>and an inverse Fourier tranform. See book Sonnen for more details. </p><h2 id="Algorithm"><a class="docs-heading-anchor" href="#Algorithm">Algorithm</a><a id="Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm" title="Permalink"></a></h2><p>Once the linear advection (or transport) equation are solved using the semi-Lagrangian method, the algorithm to solve the Vlasov-Poisson equation can now be written. To do so, we consider a uniform mesh of the phase space <span>$(x, v)$</span>.  For the spatial domain <span>$[0, L]$</span>, we introduce <span>$x_i=i\Delta x, i=0, \dots, N_x-1$</span>,  <span>$N_x$</span> being the number of points in <span>$x$</span> and <span>$\Delta x=L/N_x$</span>.  For the velocity direction, we need to consider a truncated velocity domain <span>$[-v_{\max}, v_{\max}]$</span>  and the mesh is defined by <span>$v_j = -v_{\max} + j\Delta v, j=0, \dots, N_v-1, \Delta v=2v_{\max} / N_v$</span>, <span>$N_v$</span> being the number of points in the velocity direction. </p><p>Then, the algorithm based on Lie-Trotter and semi-Lagrangian method is:</p><ol><li>Initialization. From the given initial condition <span>$f_0$</span>, we evaluate it on the phase space mesh to get <span>$f^0_{i,j}=f_0(x_i, v_j)$</span>. We then compute the initial electric field <span>$E_{0, i}\approx E_0(x_i)$</span>. </li><li>From <span>$t_n$</span> to <span>$t_{n+1}$</span>. Knowing all the grid point values of <span>$f^n$</span> and <span>$E^n$</span></li></ol><ul><li>Compute <span>$f^\star_{i,j}$</span> solving</li></ul><p class="math-container">\[\partial_t f + v\partial_x f=0, \]</p><p>using the semi-Lagrangian method <span>$f^\star_{i, j} \approx f^n(x_i-v_j\Delta t, v_j)$</span>.</p><ul><li>Solve the electric field <span>$E^\star_i$</span>  from the Poisson</li></ul><p>equation</p><p class="math-container">\[\partial_x E^\star = \sum_{j=0}^{N_v-1} f^\star_{i, j} \Delta v -1.  \]</p><ul><li>Compute <span>$f^{n+1}$</span> solving</li></ul><p class="math-container">\[\partial_t f + E^\star\partial_v f = 0, \]</p><p>using the semi-Lagrangian method <span>$f^{n+1}_{i, j} \approx f^n(x_i, v_j-E^\star_i \Delta t)$</span>. </p><p>The extension to the well-known Strang  splitting (which is second order accurate in time) can be written as follows. </p><ol><li>Initialization. From the given initial condition <span>$f_0$</span>, we evaluate it on the phase space mesh to get <span>$f^0_{i,j}=f_0(x_i, v_j)$</span>. We then compute the initial electric field <span>$E_{0, i}\approx E_0(x_i)$</span>. </li></ol><ol><li>From <span>$t_n$</span> to <span>$t_{n+1}$</span>. Knowing all the grid point values of <span>$f^n_{i,j}$</span> and <span>$E^n_i$</span></li></ol><ul><li>Compute <span>$f^\star_{i,j}$</span> solving</li></ul><p class="math-container">\[\partial_t f + v\partial_x f=0, \]</p><p>using the semi-Lagrangian method <span>$f^\star_{i, j} \approx f^n(x_i-v_j\Delta t/2, v_j)$</span>.</p><ul><li>Solve the electric field <span>$E^\star_i$</span>  from the Poisson</li></ul><p>equation</p><p class="math-container">\[\partial_x E^\star = \sum_{j=0}^{N_v-1} f^\star_{i, j} \Delta v -1.  \]</p><ul><li>Compute <span>$f^{\star\star}$</span> solving</li></ul><p class="math-container">\[\partial_t f + E^\star\partial_v f = 0, \]</p><p>using the semi-Lagrangian method <span>$f^{\star\star}_{i, j} \approx f^n(x_i, v_j-E^\star_i \Delta t)$</span>. </p><ul><li>Compute <span>$f^\star_{i,j}$</span> solving</li></ul><p class="math-container">\[\partial_t f + v\partial_x f=0, \]</p><p>using the semi-Lagrangian method <span>$f^{n+1}{i, j} \approx f^{\star\star}(x_i-v_j\Delta t/2, v_j)$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="problem/">Problem type »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 28 April 2023 16:03">Friday 28 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
